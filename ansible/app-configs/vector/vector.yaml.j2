{% import '../macros/rinoa-macros.j2' as vault %}
  sources:
    rinoa_docker_logs:
      type: docker_logs
      exclude_containers:
        - vector

  sinks:
    parseable:
      type: http
      method: post
      batch:
        max_bytes: 10485760
        max_events: 1000
        timeout_secs: 10
      compression: gzip
      inputs:
        - rinoa_docker_logs
      encoding:
        codec: json
      uri: http://parseable:8000/api/v1/ingest'
      auth:
        strategy: basic
        user: admin
        password: {{ vault.vault_secret('env', 'PARSEABLE_PASSWORD') }}
      request:
        headers:
          X-P-Stream: rinoa-docker-logs
      healthcheck:
        enabled: true
        path: 'http://parseable:8000/api/v1/liveness'
        port: 80
