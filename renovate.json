{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "prHourlyLimit": 2,
  "prConcurrentLimit": 5,
  "dependencyDashboard": true,
  "labels": ["dependencies", "renovate"],
  "schedule": ["before 6am on monday"],

  "docker": {
    "enabled": true
  },

  "packageRules": [
    {
      "matchDatasources": ["docker"],
      "matchPackageNames": ["clickhouse/clickhouse-server"],
      "enabled": false
    },
    {
      "matchDatasources": ["docker"],
      "matchPackagePatterns": [".*-alpine$"],
      "allowedVersions": "/.*-alpine$/"
    },
    {
      "matchDatasources": ["docker"],
      "matchPackagePatterns": ["^.*:latest$"],
      "enabled": false
    },
    {
      "matchDatasources": ["docker"],
      "description": "Docker image used by service {{service}} ({{depName}})"
    }
  ],

  "regexManagers": [],

  "packageFiles": [
    {
      "fileMatch": ["docker-compose\\.ya?ml$"],
      "manager": "regex",
      "extractVersion": "custom",
      "datasourceTemplate": "docker",
      "depNameTemplate": "{{service}}/{{depName}}",
      "versioningTemplate": "docker",
      "extractor": "file:extract-docker-images.js"
    }
  ],

  "branchNameStrict": true,
  "branchPrefix": "renovate/",
  "branchName": "{{service}}/{{depName}}-{{newVersion}}",

  "commitMessageAction": "Update",
  "commitMessageTopic": "{{service}}/{{depName}}",
  "commitMessageExtra": "{{currentValue}} â†’ {{newVersion}}"
}
